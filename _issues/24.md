---
title: "jq"
date: 2023-05-09 17:10:43 -0600
modified: 2023-08-31 20:37:34 -0600
id: 24
---


- [Using JQ command line arguments, functions and modules](https://apihandyman.io/api-toolbox-jq-and-openapi-part-2-using-jq-command-line-arguments-functions-and-modules/)

- [matrixzj.github.io/misc_jq](https://matrixzj.github.io/documentations/misc_jq.html)


## Examples

* [ASCII Control Characters](https://rosettacode.org/wiki/ASCII_control_characters)
* [Rosetta Code: JQ](https://rosettacode.org/wiki/Category:Jq)


Debug

```jq
(cat 1.json 2.json 1.json1) | jq -n '

# If cond is falsey, then (msg|debug); in all cases, emit .
def verify(cond; msg): 
  . as $in
  | if cond then . else (msg | debug) | $in end;

def valid_key: test("^[A-Za-z_][0-9A-Za-z_]*$");

def valid_value:
  type != "array" and 
  type != "object" and
  (type != "string" or (test("\u0000") | not) );

# $count is for the messages and for the return value
def validate($count):
   if type == "object"
   then to_entries[]
   | verify(.key | valid_key; "invalid key in entity #\($count): \(.key)")
   | verify(.value | valid_value; "invalid value in entity #\($count): \(.value)")
   else "entity #\($count) is not a JSON object" | debug
   end
   | $count;

reduce inputs as $in (0;
  .+1
  | . as $count
  | $in | validate($count) )
| verify(.==1; "only one entity is allowed")
| empty
'
```

[[Source]](https://stackoverflow.com/a/76498905)


## Template

```jq
def template:
{
  key1: "value1",
  key2: "value2",
  name: "XXX",
  familyName: "YYY"
}
;

def fillin($template):
  . as $in
  | reduce ($template|keys_unsorted[]) as $k ($template; if $in|has($k) then .[$k] = $in[$k] else . end);
```

```sh
jq 'map(fillin(template))'
```

[Source](https://stackoverflow.com/a/69921278)

